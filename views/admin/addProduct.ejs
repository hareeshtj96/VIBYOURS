<!DOCTYPE HTML>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>VIBYOURS</title>
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:title" content="">
    <meta property="og:type" content="">
    <meta property="og:url" content="">
    <meta property="og:image" content="">
    <!-- Favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="/adminAssets/assets/imgs/theme/favicon.svg">
    <!-- Template CSS -->
    <link href="/adminAssets/assets/css/main.css" rel="stylesheet" type="text/css" />
</head>

<body>
    <div class="screen-overlay"></div>
    <aside class="navbar-aside" id="offcanvas_aside">
        <div class="aside-top">
            <a href="dashboard" class="brand-wrap">
                <img src="/adminAssets/assets/imgs/theme/logo.svg" class="logo" alt="Evara Dashboard">
            </a>
            <div>
                <button class="btn btn-icon btn-aside-minimize"> <i class="text-muted material-icons md-menu_open"></i>
                </button>
            </div>
        </div>
        <nav>
            <ul class="menu-aside">
                <li class="menu-item active">
                    <a class="menu-link" href="adminHome"> <i class="icon material-icons md-home"></i>
                        <span class="text">HOME</span>
                    </a>
                </li>
                <li class="menu-item has-submenu">
                    <a class="menu-link" href="page-products-list.html"> <i
                            class="icon material-icons md-shopping_bag"></i>
                        <span class="text">Products</span>
                    </a>
                    <div class="submenu">
                        <!-- <a href="page-products-list.html">Product List</a> -->
                        <a href="viewProduct">Product list</a>
                        <a href="category">Categories</a>
                        <a href="addProduct">Add product</a>

                    </div>
                </li>
                <li class="menu-item has-submenu">
                    <a class="menu-link" href="page-orders-1.html"> <i class="icon material-icons md-shopping_cart"></i>
                        <span class="text">Orders</span>
                    </a>
                    <div class="submenu">
                        <a href="orderList">Order list</a>
                        <!-- <a href="page-orders-detail.html">Order detail</a>
                        <a href="page-orders-tracking.html">Order tracking</a> -->
                        <!-- <a href="page-invoice.html">Invoice</a> -->
                    </div>
                </li>
                <!-- <li class="menu-item has-submenu">
                    <a class="menu-link" href=""> <i class="icon material-icons md-store"></i>
                        <span class="text">Users</span>
                    </a>
                    <div class="submenu">
                        <a href="page-sellers-cards.html">Sellers cards</a>
                        <a href="page-sellers-list.html">Sellers list</a>
                        <a href="page-seller-detail.html">Seller profile</a>
                    </div> -->
                <!-- </li> -->
                <!-- <li class="menu-item has-submenu">
                    <a class="menu-link" href="page-form-product-1.html"> <i class="icon material-icons md-add_box"></i>
                        <span class="text">Add product</span>
                    </a>
                    <div class="submenu">

                        <a href="addProduct">Add product</a>

                    </div>
                </li> -->
                <!-- <li class="menu-item has-submenu">
                    <a class="menu-link" href="page-transactions-1.html"> <i class="icon material-icons md-monetization_on"></i>
                        <span class="text">Transactions</span>
                    </a>
                    <div class="submenu">
                        <a href="page-transactions-1.html">Transaction 1</a>
                        <a href="page-transactions-2.html">Transaction 2</a>
                        <a href="page-transactions-details.html">Transaction Details</a>
                    </div>
                </li> -->
                <li class="menu-item has-submenu">
                    <a class="menu-link" href="#"> <i class="icon material-icons md-person"></i>
                        <span class="text">Users</span>
                    </a>
                    <div class="submenu">
                        <a href="adminDashboard">Users</a>
                        <!-- <a href="page-account-register.html">User registration</a> -->
                        <!-- <a href="page-error-404.html">Error 404</a> -->
                    </div>
                </li>
                <li class="menu-item">
                    <a class="menu-link" href="couponManagement"> <i class="icon material-icons md-monetization_on"></i>
                        <span class="text">Coupon</span>
                    </a>
                </li>
                <!-- <li class="menu-item">
                    <a class="menu-link" href="page-brands.html"> <i class="icon material-icons md-stars"></i>
                        <span class="text">Brands</span> </a>
                </li> -->
                <li class="menu-item">
                    <a class="menu-link"  href="salesReport"> <i class="icon material-icons md-pie_chart"></i>
                        <span class="text">Sales Report</span>
                    </a>
                </li>
                <li class="menu-item has-submenu">
                    <a class="menu-link" href="page-orders-1.html"> <i class="icon material-icons md-add_box"></i>
                        <span class="text">Offer Management</span>
                    </a>
                    <div class="submenu">
                        <a href="productOffer">Product Offers</a>
                        <a href="categoryOffer">Category Offers</a>
                       
                    </div>
                </li>
            </ul>
            <hr>
            <!-- <ul class="menu-aside">
                <li class="menu-item has-submenu">
                    <a class="menu-link" href="#"> <i class="icon material-icons md-settings"></i>
                        <span class="text">Settings</span>
                    </a>
                    <div class="submenu">
                        <a href="page-settings-1.html">Setting sample 1</a>
                        <a href="page-settings-2.html">Setting sample 2</a>
                    </div>
                </li>
                <li class="menu-item">
                    <a class="menu-link" href="page-blank.html"> <i class="icon material-icons md-local_offer"></i>
                        <span class="text"> Starter page </span>
                    </a>
                </li>
            </ul> -->
            <br>
            <br>
        </nav>
    </aside>
    <main class="main-wrap">
        <header class="main-header navbar">
            <div class="col-search">
                <form class="searchform">
                    <div class="input-group">
                        <input list="search_terms" type="text" class="form-control" placeholder="Search term">
                        <button class="btn btn-light bg" type="button"> <i
                                class="material-icons md-search"></i></button>
                    </div>
                    <datalist id="search_terms">
                        <option value="Products">
                        <option value="New orders">
                        <option value="Apple iphone">
                        <option value="Ahmed Hassan">
                    </datalist>
                </form>
            </div>
            <div class="col-nav">
                <button class="btn btn-icon btn-mobile me-auto" data-trigger="#offcanvas_aside"> <i
                        class="material-icons md-apps"></i> </button>
                <ul class="nav">
                    <li class="nav-item">
                        <a class="nav-link btn-icon" href="#">
                            <i class="material-icons md-notifications animation-shake"></i>
                            <span class="badge rounded-pill">3</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link btn-icon darkmode" href="#"> <i class="material-icons md-nights_stay"></i>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="requestfullscreen nav-link btn-icon"><i
                                class="material-icons md-cast"></i></a>
                    </li>
                    <!-- <li class="dropdown nav-item">
                        <a class="dropdown-toggle" data-bs-toggle="dropdown" href="#" id="dropdownLanguage"
                            aria-expanded="false"><i class="material-icons md-public"></i></a>
                        <div class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownLanguage">
                            <a class="dropdown-item text-brand" href="#"><img src="assets/imgs/theme/flag-us.png"
                                    alt="English">English</a>
                            <a class="dropdown-item" href="#"><img src="assets/imgs/theme/flag-fr.png"
                                    alt="Français">Français</a>
                            <a class="dropdown-item" href="#"><img src="assets/imgs/theme/flag-jp.png"
                                    alt="Français">日本語</a>
                            <a class="dropdown-item" href="#"><img src="assets/imgs/theme/flag-cn.png"
                                    alt="Français">中国人</a>
                        </div>
                    </li> -->
                    <li class="dropdown nav-item">
                        <a class="dropdown-toggle" data-bs-toggle="dropdown" href="#" id="dropdownAccount"
                            aria-expanded="false"> <img class="img-xs rounded-circle"
                                src="/adminAssets/assets/imgs/people/avatar1.jpeg" alt="User"></a>
                        <div class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownAccount">
                            <a class="dropdown-item" href="#"><i class="material-icons md-perm_identity"></i>Edit
                                Profile</a>
                            <a class="dropdown-item" href="#"><i class="material-icons md-settings"></i>Account
                                Settings</a>
                            <a class="dropdown-item" href="#"><i
                                    class="material-icons md-account_balance_wallet"></i>Wallet</a>
                            <a class="dropdown-item" href="#"><i class="material-icons md-receipt"></i>Billing</a>
                            <a class="dropdown-item" href="#"><i class="material-icons md-help_outline"></i>Help
                                center</a>
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item text-danger" href="logout"><i
                                    class="material-icons md-exit_to_app"></i>Logout</a>
                        </div>
                    </li>
                </ul>
            </div>
        </header>
        <section class="content-main">

            <form action="/admin/addProduct" method="post" enctype="multipart/form-data" id="form">
                <div id="errorMessage" class="error"></div>
                <div class="row">
                    <div class="col-6">
                        <div class="content-header">
                            <h2 class="content-title">Add New Product</h2>
                            <div>
                                <button type="button" class="btn btn-light rounded font-sm mr-5 text-body hover-up">Save
                                    to draft</button>
                                <button type="submit" class="btn btn-md rounded font-sm hover-up">Publish</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-lg-6">
                        <div class="card mb-4">
                            <div class="card-body">
                                <!-- General info -->
                                <div class="row">
                                    <div class="col-md-3">
                                        <h6>1. General info</h6>
                                    </div>
                                    <div class="col-md-9">
                                        <div class="mb-4">
                                            <label class="form-label">Product title</label>
                                            <input type="text" placeholder="Type here" class="form-control"
                                                id="producttitle" name="producttitle" onkeyup="validateTitle()">
                                            <p id="titleError" class="error"></p>
                                        </div>
                                        <div class="mb-4">
                                            <label class="form-label">Description</label>
                                            <textarea placeholder="Type here" class="form-control" rows="4"
                                                id="description" name="description"
                                                onkeyup="validateDescription()"></textarea>
                                            <p id="descriptionError" class="error"></p>

                                        </div>
                                        <div class="mb-4">
                                            <label class="form-label">Brand name</label>
                                            <select class="form-select" name="brand" onkeyup="validateBrand()">

                                                <option value="Bluorng">Bluorng</option>
                                                <option value="H&M">H&M</option>
                                               
                                            </select>
                                        </div>
                                        <!-- <div class="mb-4">
                                            <label class="form-label">Size</label>
                                            <select class="form-select" name="size" onblur="validateSize()">
                                                <option value="s">S</option>
                                                <option value="m">M</option>
                                                <option value="l">L</option>
                                                <option value="xl">XL</option>
                                            </select>
                                        </div> -->
                                        <div class="mb-4">
                                            <label class="form-label">Size S</label>
                                            <input type="number" placeholder="Add quantity" class="form-control" name="sizeS" onblur="validateSize('S')" min="0" max="100">
                                            <label class="form-label">Size M</label>
                                            <input type="number" placeholder="Add quantity" class="form-control" name="sizeM" onblur="validateSize('M')" min="0" max="100">
                                            <label class="form-label">Size L</label>
                                            <input type="number" placeholder="Add quantity" class="form-control" name="sizeL" onblur="validateSize('L')" min="0" max="100">
                                            <label class="form-label">Size XL</label>
                                            <input type="number" placeholder="Add quantity" class="form-control" name="sizeXL" onblur="validateSize('XL')" min="0" max="100">
                                        </div>
                                    </div>
                                </div>
                                <hr class="mb-4 mt-0">

                                <!-- Pricing -->
                                <div class="row">
                                    <div class="col-md-3">
                                        <h6>2. Pricing</h6>
                                    </div>
                                    <div class="col-md-9">
                                        <div class="mb-4">
                                            <label class="form-label">Cost</label>
                                            <input type="text" placeholder="Rs" class="form-control" value="" id="price"
                                                name="price" required
                                                onkeydown="return/[0-9\b]/i.test(event.key) || event.keyCode === 8"
                                                onkeyup="validatePrice()">
                                            <p id="priceError" class="error"></p>

                                        </div>

                                        <div class="mb-4">
                                            <label class="form-label">Selling Price</label>
                                            <input type="text" placeholder="Rs" class="form-control" value="" id="sellingPrice"
                                                name="sellingPrice" required
                                                onkeydown="return/[0-9\b]/i.test(event.key) || event.keyCode === 8"
                                                onkeyup="validateSellingPrice()">
                                            <p id="SellingpriceError" class="error"></p>

                                        </div>


                                    </div>
                                    
                                </div>
                                <hr class="mb-4 mt-0">

                                <!-- Category -->
                                <div class="row">
                                    <div class="col-md-3">
                                        <h6>3. Category</h6>
                                    </div>
                                    


                                    <div class="col-md-9">
                                        <div class="mb-4">
                                            <label class="mb-2">
                                                <select class="form-select" name="category" required
                                                    onblur="validateCategory()">

                                                   <option value="" selected>None</option>
                                                    <% categories.forEach(function(category) { %>
                                                        <option value="<%= category._id %>">
                                                            <%= category.name %>
                                                        </option>
                                                        <% }) %>
                                                   
                                                        
                                                </select>
                                            </label>
                                        </div>
                                    </div>

                                </div>
                                <hr class="mb-4 mt-0">

                                <!-- Media -->
                                <div class="row">
                                    <div class="col-md-3">
                                        <h6>4. Media</h6>
                                    </div>
                                    <div class="col-md-9">
                                        <div class="mb-4">
                                            <label class="form-label">Images</label>
                                            <input class="form-control" type="file" name="images" multiple id="images"
                                                onblur="validateImages()"  onchange="previewImages()">
                                            <p id="imagesError" class="error"></p>
                                        </div>
                                        <div id="imagePreviewContainer"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </form>

        </section>
        <footer class="main-footer font-xs">
            <div class="row pb-30 pt-15">
                <div class="col-sm-6">
                    <script>
                        document.write(new Date().getFullYear())
                    </script> ©, VIBYOURS .
                </div>
                <div class="col-sm-6">
                    <div class="text-sm-end">
                        All rights reserved
                    </div>
                </div>
            </div>
        </footer>
    </main>
    <script src="/adminAssets/assets/js/vendors/jquery-3.6.0.min.js"></script>
    <script src="/adminAssets/assets/js/vendors/bootstrap.bundle.min.js"></script>
    <script src="/adminAssets/assets/js/vendors/select2.min.js"></script>
    <script src="/adminAssets/assets/js/vendors/perfect-scrollbar.js"></script>
    <script src="/adminAssets/assets/js/vendors/jquery.fullscreen.min.js"></script>
    <!-- Main Script -->
    <script src="/adminAssets/assets/js/main.js" type="text/javascript"></script>


    <script>


        function validateTitle() {

            const productname = document.getElementById('producttitle').value.trim();

            const titleError = document.getElementById('titleError');

            if (productname == "") {

                titleError.innerHTML = "product title is required"
                setTimeout(function () {
                    titleError.innerHTML = ""
                }, 3000);
            } else {
                titleError.innerHTML = ""
            }
        }


        function validateDescription() {

            const productDescription = document.getElementById('description').value.trim();

            const descriptionError = document.getElementById('descriptionError');

            if (productDescription == "") {

                descriptionError.innerHTML = "Product description is required"
                setTimeout(function () {
                    descriptionError.innerHTML = ""
                }, 3000);
            } else {
                descriptionError.innerHTML = ""
            }
        }

        function validatePrice() {


            const Priceinput = document.getElementById('price').value.trim();

            const priceError = document.getElementById('priceError');

            if (Priceinput == "") {

                priceError.innerHTML = "product price is required";
                setTimeout(function () {
                    priceError.innerHTML = ""
                }, 3000);


            } else if (Priceinput < 0) {
                priceError.innerHTML = "product price must be positive";
                setTimeout(function () {
                    priceError.innerHTML = ""
                }, 3000);
            } else {
                priceError.innerHTML = "";
            }

        }

        function validateSellingPrice() {
            const price = document.getElementById('price').value.trim();

            const sellingPrice = document.getElementById('sellingPrice').value.trim();

            const SellingpriceError = document.getElementById('SellingpriceError');

            if(sellingPrice == "") {

                SellingpriceError.innerHTML = "Selling price is required";
                setTimeout(function() {
                    SellingpriceError.innerHTML = ""
                }, 3000);

            } else if(sellingPrice > price) {

                SellingpriceError.innerHTML = "Invalid price!";
                setTimeout(function() {
                    SellingpriceError.innerHTML = ""
                }, 3000);

            } else if(sellingPrice < 0) {
                SellingpriceError.innerHTML = "Invalid price!";
                setTimeout(() => {
                    SellingpriceError.innerHTML = ""
                }, 3000);
            } else {
                SellingpriceError.innerHTML = ""
            }

        }

        


        function validateImages() {
            const productImageInput = document.getElementById('images');
            const imageError = document.getElementById('imagesError');

            // Check if an image is submitted
            if (!productImageInput.files || productImageInput.files.length === 0) {
                imageError.innerHTML = "Image is required";
                setTimeout(function () {
                    imageError.innerHTML = "";
                }, 3000);
                return;
            }

            // Get the file object
            const productImage = productImageInput.files[0];

            // Check file extension and MIME type
            const allowedExtensions = ['jpeg', 'jpg', 'webp', 'png'];
            const allowedMimeTypes = ['image/jpeg', 'image/jpg', 'image/webp', 'image/png'];

            const fileExtension = productImage.name.split('.').pop().toLowerCase();
            const fileMimeType = productImage.type.toLowerCase();

            if (!allowedExtensions.includes(fileExtension) || !allowedMimeTypes.includes(fileMimeType)) {
                imageError.innerHTML = "Invalid image format. Allowed formats: jpeg, jpg, webp, png";
                setTimeout(function () {
                    imageError.innerHTML = "";
                }, 3000);
                return;
            } else {
                imageError.innerHTML = "";
            }


        }



        document.getElementById("form").addEventListener("submit", (e) => {


            validateTitle()
            validateDescription()
            validatePrice()
            validateSellingPrice() 
            validateImages()


            if (titleError.innerHTML || descriptionError.innerHTML || priceError.innerHTML || SellingpriceError.innerHTML || imageError.innerHTML) {
                e.preventDefault();
            } else {

            }
        });


    </script>

<script>
    function previewImages() {
        const imageContainer = document.getElementById('imagePreviewContainer');
        imageContainer.innerHTML = ''; 

        const input = document.getElementById('images');
        const files = input.files;

        for (const file of files) {
            const reader = new FileReader();

            reader.onload = function (e) {
                const imgElement = document.createElement('img');
                imgElement.src = e.target.result;
                imgElement.className = 'preview-image';

                const deleteButton = document.createElement('button');
                deleteButton.textContent = 'x';
                deleteButton.className = 'delete-button';
                deleteButton.onclick = function () {
                    imageContainer.removeChild(container);

                    const updatedFiles = Array.from(input.files).filter(f=> f!== file);


                    input.files = new FileList(updatedFiles, input.files.item(0).name);
                };

                const container = document.createElement('div');
                container.className = 'image-container';
                container.appendChild(imgElement);
                container.appendChild(deleteButton);

                imageContainer.appendChild(container);
            };

            reader.readAsDataURL(file);
        }
    }
</script>


    <style>
        .error {
            color: red;
            font-size: 14px;
            margin-top: 5px;
        }

        .error-message {
            color: red;
            font-size: 16px;
            margin-bottom: 10px;
        }
    </style>

<style>
    .image-container {
        display: inline-block;
        margin-right: 10px;
    }

    .preview-image {
        width: 100px;
        height: 100px;
        object-fit: cover;
        border: 1px solid #ccc;
        margin-bottom: 5px;
    }

    .delete-button {
        cursor: pointer;
        background-color: #e74c3c;
        color: #fff;
        border: none;
        padding: 5px 8px;
        border-radius: 3px;
    }
</style>



</body>

</html>